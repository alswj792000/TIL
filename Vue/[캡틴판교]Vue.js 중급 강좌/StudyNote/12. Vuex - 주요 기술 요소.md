# Vuex - ì£¼ìš” ê¸°ìˆ  ìš”ì†Œ

ì„¹ì…˜: Vuex
ìˆ˜ê°•ì¼: 2022ë…„ 10ì›” 19ì¼ â†’ 2022ë…„ 10ì›” 20ì¼
ì§„í–‰ë„: 1

# Vuex ì„¤ì¹˜ ë° ë“±ë¡

### âœ” Vuex ì„¤ì¹˜

VuexëŠ” ì‹±ê¸€ íŒŒì¼ ì»´í¬ë„ŒíŠ¸ ì²´ê³„ì—ì„œ NPM ë°©ì‹ìœ¼ë¡œ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì„¤ì¹˜í•˜ëŠ”ê²ƒì´ ì¢‹ë‹¤.

```jsx
// ES6 : ES6ì™€ í•¨ê»˜ ì‚¬ìš©í•´ì•¼ ë” ë§ì€ ê¸°ëŠ¥ê³¼ ì´ì ì„ ì œê³µë°›ì„ ìˆ˜ ìˆë‹¤.
npm install vuex --save
npm i vuex@3.6.2 // 2022.02.07ë¶€í„° Vuex ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì„¤ì¹˜í•  ë•Œ ë¼ì´ë¸ŒëŸ¬ë¦¬ ë²„ì „ì„ ëª…ì‹œí•´ì¤˜ì•¼ í•œë‹¤
```

### âœ” Store ë“±ë¡

1. src ë°‘ì— `store` í´ë” ìƒì„± í›„ `store.js` íŒŒì¼ìƒì„±
2. `store.js`ì— Vuex í˜¸ì¶œ
    
    ```jsx
    import Vue from 'vue'
    import Vuex from 'vuex'
    
    Vue.use(Vuex); // Vue.use() 
    export const store = new Vuex.Store({ 
        // .....
    });
    ```
    
    - `Vue.use()` : Vueì˜ í”ŒëŸ¬ê·¸ì¸ ê¸°ëŠ¥. vueë¥¼ ì‚¬ìš©í•˜ëŠ” ëª¨ë“  ì˜ì—­ì— íŠ¹ì • ê¸°ëŠ¥ì„ ì¶”ê°€í•˜ê³  ì‹¶ì„ë•Œ ì‚¬ìš©í•œë‹¤. (ì „ì—­ë“±ë¡)
    - exportë¡œ const store í•˜ëŠ” ìˆœê°„. storeë¼ëŠ” ë³€ìˆ˜ëŠ” ë°–ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. (`ES6`ì˜ íŠ¹ì§•)
        - ì´ storeì— ë‹¤ë¥¸ íŒŒì¼ì´ ì ‘ê·¼í•˜ë ¤ë©´ ì ‘ê·¼í•˜ê¸°ë¥¼ ì›í•˜ëŠ” ìœ„ì¹˜ì—ì„œ `import` í•´ì£¼ë©´ ëœë‹¤.
3. `Main.js`ì—ì„œ Vuexë¥¼ ì‚¬ìš©í•˜ê¸°ìœ„í•´ store `import`

```jsx
import Vue from 'vue'
import App from './App.vue'
import { store } from './store/store' // main.jsì—ì„œ Vuexë¥¼ ì“°ê³ ìí•˜ë©´ storeë¥¼ import í•´ì¤˜ì•¼ í•œë‹¤.

Vue.config.productionTip = false

new Vue({
  // store ë³€ìˆ˜ ë“±ë¡
  // store: store ì„ ì¶•ì•½ â†’ ES6ì˜ íŠ¹ì§•!
  store,
  render: h => h(App)
}).$mount('#app')
```

- `main.js`ì—ì„œ Vuexë¥¼ ì“°ê³ ìí•˜ë©´ `store`ë¥¼ `import` í•´ì¤˜ì•¼ í•œë‹¤.

---

# Vuex ê¸°ìˆ  ìš”ì†Œ

- `state` : ì—¬ëŸ¬ ì»´í¬ë„ŒíŠ¸ì— ê³µìœ ë˜ëŠ” ë°ì´í„° `data`
- `getters` : ì—°ì‚°ëœ `state` ê°’ì„ ì ‘ê·¼í•˜ëŠ” ì†ì„± `computed`
- `mutations` : `state` ê°’ì„ ë³€ê²½í•˜ëŠ” ì´ë²¤íŠ¸ ë¡œì§, ë©”ì„œë“œ `methods`
- `actions` : ë¹„ë™ê¸° ì²˜ë¦¬ ë¡œì§ì„ ì„ ì–¸í•˜ëŠ” ë©”ì„œë“œ `aysnc methods`

---

# stateì™€ getters ì†Œê°œ

### âœ” state

ì—¬ëŸ¬ ì»´í¬ë„ŒíŠ¸ ê°„ì— ê³µìœ í•  ë°ì´í„° - **ìƒíƒœ**

```jsx
// Vue
data: {
	message: 'Hello Vue.js!'
}

// Vuex
state: {
	message: 'Hello Vue.js!'
}
```

```jsx
<!-- templateì—ì„œ ì ‘ê·¼ -->
<!-- Vue -->
<p>{{ message }}</p>

<!-- Vuex -->
<p>{[ this.$store.state.message }}</p>
```

### âœ” getters

`state` ê°’ì„ ì ‘ê·¼í•˜ëŠ” ì†ì„±ì´ì `computed()`ì²˜ëŸ¼ ë¯¸ë¦¬ ì—°ì‚°ëœ ê°’ì„ ì ‘ê·¼í•˜ëŠ” ì†ì„±

```jsx
// store.js
state: {
	num: 10
}, 
getters: {
	getNumber(state) {
		return state.num
	},
	doubleNumber(state) {
		return state.num * 2;
	}
}
```

```jsx
<p>{{ this.$store.getters.getNumber }}</p>
<p>{{ this.$store.getters.doubleNumber }}</p>
```

---

# [ë¦¬íŒ©í† ë§] state ì†ì„± ì ìš©

<aside>
ğŸ’¡ ê°€ì§€ê³  ìˆëŠ” ì»´í¬ë„ŒíŠ¸ ì¤‘ staticí•œ ë¬¸ìì—´ì„ ë„£ì„ìˆ˜ ìˆëŠ”  headerì— ê°€ì ¸ì™€ ê°’ì„ ì¶”ê°€í•´ë³´ì.

</aside>

### âœ” src>store>store.js

```jsx
import Vue from 'vue'
import Vuex from 'vuex'

Vue.use(Vuex); 

export const store = new Vuex.Store({ 
    state: {
        headerText: 'TODO it!' 
    }
});
```

- stateì— headerTextë¥¼ ì¶”ê°€í•œë‹¤.

### âœ” src > components > TodoHeader.vue

```jsx
<template>
  <header> 
    <!-- store > state ì†ì„± ì ìš©ì„ ìœ„í•´ ì£¼ì„ ì²˜ë¦¬ -->
    <!-- <h1>TODO it!</h1> -->
    <h1>{{ this.$store.state.headerText }}</h1>
  </header>
</template>
```

- ì½§ìˆ˜ì—¼ ê´„í˜¸ë¥¼ ì‚¬ìš©í•´ stateê°’ì„ ë°›ì•„ì˜¨ë‹¤.

<aside>
ğŸ’¡ 1. App.vueì— ìˆë˜ todoItemsë¥¼ store.jsë¡œ ê°€ì ¸ì™€ í™”ë©´ì— ì•„ì´í…œì„ ë¿Œë¦°ë‹¤.
2. localStorageì™€ ê´€ë ¨ëœ ë‚´ìš©ë“¤ì„ App.vueì—ì„œ store.jsë¡œ ì´ë™ì‹œì¼œë³´ì

</aside>

### âœ” src>App.vue

```jsx
<template>
  <!-- ..... -->
</template>

<script>
import .....

export default {
	// props: ['propsdata'], // props ì†ì„± ì—†ì´ë„ ì‘ë™í•˜ê¸°ë•Œë¬¸ì— ì£¼ì„
  data(){
    return {
      // store.jsë¡œ ì´ë™
      todoItems: [] 
    }
  },
  methods: {
    //.....
  },
  // *------ store.jsë¡œ ì´ë™
  // created () {
  //   console.log('created');

  //   if (localStorage.length > 0) {
  //     // for (var i = 0; i < localStorage.length; i++) {
  //     for (let i = 0; i < localStorage.length; i++) { 

  //       this.todoItems.sort();
  //       if (localStorage.key(i) !== 'loglevel:webpack-dev-server') {
  //         this.todoItems.push(JSON.parse(localStorage.getItem(localStorage.key(i)))); 
  //       }
  //     }
  //   }
  // },
  components: {
		// .....
	}
}
</script>

<style>
  /* ..... */
</style>
```

- dataì˜ `todoItems: []` ê³¼ `methodsì˜ created { }`ë¥¼ store.jsë¡œ ë³´ë‚¸ë‹¤.

### âœ” src>store>store.js

```jsx
import Vue from 'vue'
import Vuex from 'vuex'

Vue.use(Vuex); 

// localStorageì™€ ê´€ë ¨ëœ ë™ì‘ë“¤ì„ ì—¬ê¸°ë¡œ ëº„ê²ƒ.
const storage = {
    fetch() { // fetch function()ì™€ ê°™ìŒ
        // App.vueì—ì„œ ë“¤ê³ ì˜¨ created ì‚½ì…
        // --- ì½”ë“œ ìˆ˜ì •
        const arr = [];
        // created () {
            if (localStorage.length > 0) {
                for (let i = 0; i < localStorage.length; i++) { 
                    arr.sort();
                    if (localStorage.key(i) !== 'loglevel:webpack-dev-server') {
                        // this.todoItems.push(JSON.parse(localStorage.getItem(localStorage.key(i))));
                        // scopedì´ ë‹¤ë¥´ê¸°ë•Œë¬¸ì— stateì˜ todoItemsë¡œ ì ‘ê·¼í• ìˆ˜ ì—†ë‹¤.
                        // ì ‘ê·¼í•  ìˆ˜ìˆë„ë¡ this.todoItemsë¥¼ ìˆ˜ì • : ìƒˆë¡œë§Œë“  ë¹ˆë°°ì—´ arrì•ˆì— localStorageê°’ë“¤ì„ push
                        arr.push(JSON.parse(localStorage.getItem(localStorage.key(i)))); 
                    }
                }
            }
            // pushë°›ì€ arrì„ return
            return arr;
        // },
    }
};

export const store = new Vuex.Store({ 
    state: {
        // App.vueì— ìˆë˜ todoItemsì„ ê°€ì ¸ì™€ stateë¥¼ ì‚¬ìš©í•´ ì•„ì´í…œì„ ë¿Œë¦°ë‹¤.
        todoItems: storage.fetch()
    }
});
```

- `state` ì— `App.vue`ì—ì„œ ê°€ì ¸ì˜¨ `todoItems:[]`ë¥¼ ë„£ëŠ”ë‹¤.
- localStorageì™€ ê´€ë ¨ëœ ë™ì‘ì„ `store.js`ë¡œ ë¹¼ê¸°ìœ„í•´ `const storage = { fetch() }`ë¥¼ ì‚¬ìš©í•œë‹¤.
    - `fetch()` : ì†ì„±ë©”ì„œë“œ
    - App.vueì—ì„œ ê°€ì ¸ì˜¨ `created` ì½”ë“œë¥¼ ì‚½ì…í•œë‹¤.
- scopeê°€ ë‹¬ë¼ stateì˜ `todoItems`ë¡œ ì ‘ê·¼í• ìˆ˜ ì—†ê²Œ ë˜ì—ˆê¸°ë•Œë¬¸ì— í•´ë‹¹ ë¶€ë¶„ì— ì ‘ê·¼í• ìˆ˜ ìˆë„ë¡ ìˆ˜ì •í•œë‹¤.
    - `fetch`ì•ˆì— ë¹ˆ ë°°ì—´ `const arr`ì„ ë§Œë“¤ê³ , `this.todoItems`ëŒ€ì‹  `arr`ì•ˆì— `localStorage`ê°’ë“¤ì„ `push`í•œë‹¤.
    - ifë¬¸ ë°–ì—ì„œ arrì„ returní•œë‹¤.
- `state`ì˜ `todoItems`ì— ê¸°ì¡´ì˜ ë¹ˆë°°ì—´ì„ ì§€ìš°ê³  ê·¸ ìë¦¬ì— `storage.fetch()`ë¥¼ ë„£ëŠ”ë‹¤.

---

# mutationsì™€ commit() í˜•ì‹ ì†Œê°œ

### âœ” mutations

stateì˜ ê°’ì„ ë³€ê²½í•  ìˆ˜ ìˆëŠ” ìœ ì¼í•œ ë°©ë²•ì´ì ë©”ì„œë“œ

ë®¤í…Œì´ì…˜ì€ commit()ìœ¼ë¡œ ë™ì‘ì‹œí‚¨ë‹¤.

```jsx
// store.js
state: {num: 10},
mutations: {
	printNumber(state) { // ì†ì„± ë©”ì„œë“œ
		return stage.num
	},
	sumNumbers(state, anotherNum) {
		return stage.num + anotherNum;
	}
}

// App.vue
this.$store.commit('printNumbers'); // 10
this.$store.commit('sumNumbers', 20); // 30
```

- mutationsëŠ” ì†ì„±ë©”ì„œë“œì˜ ì²«ë²ˆì§¸ ì¸ìë¡œ í•­ìƒ `state`ë¥¼ ê°€ì ¸ì˜¨ë‹¤. ê·¸ë˜ì„œ mutationsì—ì„œ `state`ë¥¼ ì¡°ì‘í•  ìˆ˜ ìˆë‹¤.
- Appì´ë¼ëŠ” ì»´í¬ë„ŒíŠ¸ì—ì„œ store.jsì˜ ê°’ë“¤ì— ì ‘ê·¼í•˜ë ¤ë©´ `this.$store.commit()`ìœ¼ë¡œ ì ‘ê·¼í•œë‹¤.
    - `commit()`  : **mutationsì„ ë°œë™/ë™ì‘**ì‹œí‚¤ëŠ” ëª…ë ¹ì–´. mutationsëª…ì„ ë„˜ê¸°ë©´ì„œ `ì¸ì`ë„ ê°™ì´ ë„˜ê¸¸ ìˆ˜ ìˆë‹¤.

### âœ” mutationsì˜ commit() í˜•ì‹

- stateë¥¼ ë³€ê²½í•˜ê¸°ìœ„í•´ mutationsë¥¼ ë™ì‘ì‹œí‚¬ ë•Œ `ì¸ì(payload)`ë¥¼ ì „ë‹¬í•  ìˆ˜ ìˆë‹¤.
- ì—¬ëŸ¬ê°€ì§€ ê°’ì„ í•œë²ˆì— ë³´ë‚´ê³ ì‹¶ì„ë•ŒëŠ” ê°ì²´í™” ì‹œì¼œ `key-value` í˜•íƒœë¡œ ë³´ë‚´ì¤€ë‹¤.

```jsx
// store.js
state: {storeNum: 10},
mutations: {
	modifyState(state, payload) {
		console.log(payload.str);
		return state.storeNum += payload.num;
	}
}

// App.vue
this.$store.commit('modifyState', {
	// ì—¬ëŸ¬ê°€ì§€ ê°’ì„ í•œë²ˆì— ë³´ë‚´ê³ ì‹¶ì„ë•ŒëŠ” ê°ì²´í™” ì‹œì¼œ key-value í˜•íƒœë¡œ ë³´ë‚´ì¤€ë‹¤.
	str: 'passed from payload',
	num: 20
});
```

---

# [ë¦¬íŒ©í† ë§&í€´ì¦ˆ] í•  ì¼ ì¶”ê°€ ê¸°ëŠ¥ êµ¬í˜„

<aside>
ğŸ’¡ ê¸°ì¡´ì— App.vueì™€ TodoInput.vueë¥¼ ì—°ê²°í•´ ì‘ë™í–ˆë˜ Todoì¶”ê°€ ê¸°ëŠ¥ì„ Storeì™€ TodoInput.vueë¥¼ ì§ì ‘ ì—°ê²°í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ë³€ê²½í•´ë³´ì

</aside>

### âœ” src>App.vue

```jsx
<template>
  <div id="app">
    <TodoHeader></TodoHeader>
    <!-- <TodoInput v-on:addTodoItem="addOneItem"></TodoInput>  -->
    <TodoInput></TodoInput> <!-- ì˜ˆì „ì—ëŠ” inputì—ì„œ appìœ¼ë¡œ ë„˜ì–´ì™”ì—ˆëŠ”ë° ì§€ê¸ˆì€ storeì™€ inputì´ ì§ì ‘ì ìœ¼ë¡œ ì—°ê´€ìˆìŒ. ë”°ë¼ì„œ inputê³¼ì˜ ì—°ê²° í•´ì œ -->
    <TodoList v-bind:propsdata="todoItems" 
              v-on:removeItem="removeOneItem" 
              v-on:toggleItem="toggleOneItem">
    </TodoList> 
    <TodoFooter v-on:clearAll="clearAllItems"></TodoFooter>
  </div>
</template>

<script>
import .....

export default {
  data(){
    return {
      todoItems: [] 
    }
  },
  methods: { // storeì˜ mutationsì™€ ê°™ë‹¤.
    // *----- storeë¡œ ì´ë™
    // addOneItem (todoItem) { 
    //   // var obj = { completed: false, item: todoItem }; 
    //   const obj = { completed: false, item: todoItem }; 
    //   localStorage.setItem(todoItem, JSON.stringify(obj));
    //   this.todoItems.push(obj); 
    // },
    removeOneItem (todoItem, index) { 
			// .....
    },
    toggleOneItem (todoItem, index){
      // .....
    },
    clearAllItems(){
     // .....
    }
  },
  components: {
		// .....
	}
}
</script>

<style>
	 // .....
</style>
```

- `methods` : storeì˜ `mutations`ì™€ ê°™ë‹¤.
- addOneItem (todoItem)ì„ store.jsë¡œ ì´ë™ì‹œí‚¤ê³  ì‚­ì œí•œë‹¤.
- ì´ì „ì—ëŠ” TodoInput.vueì—ì„œ App.vueë¡œ ê°’ì´ ë„˜ì–´ì™”ëŠ”ë° ì§€ê¸ˆì€ **storeê³¼ TodoInput.vueë¥¼ ì§ì ‘ì ìœ¼ë¡œ ì—°ê²°í–ˆê¸°ë•Œë¬¸ì— App.vueì—ì„œ TodoInputê³¼ì˜ ì—°ê²°ì„ í•´ì œ**í•œë‹¤.

### âœ”  src>store>store.js

```jsx
import Vue from 'vue'
import Vuex from 'vuex'

Vue.use(Vuex); 

const storage = {
	fetch() {
		const arr = [];
			if (localStorage.length > 0) {
				for (let i = 0; i < localStorage.length; i++) { 
					arr.sort();
					if (localStorage.key(i) !== 'loglevel:webpack-dev-server') {
						arr.push(JSON.parse(localStorage.getItem(localStorage.key(i)))); 
					}
				}
			}
			return arr;
		}
};

export const store = new Vuex.Store({ 
    state: {
        todoItems: storage.fetch()
    },
    mutations: {
        // App.vueì—ì„œ ì´ë™!
        addOneItem (state, todoItem) { // ê¸°ì¡´ì— todoInputì—ì„œ todoItemì¸ìë¥¼ ë°›ì•˜ìŒ â†’ stateì™€ todoItem ì¸ìë¥¼ ë°›ëŠ”ë‹¤.
            const obj = { completed: false, item: todoItem }; 
            localStorage.setItem(todoItem, JSON.stringify(obj));
            // this.todoItems.push(obj); // this.todoItemê°€ ì•„ë‹Œ stateë¡œ ì ‘ê·¼í•´ì•¼ í•œë‹¤.
            state.todoItems.push(obj);
        },
    }
});
```

- App.vueì—ì„œ addOneItem(todoItem)ì„ ì´ë™í•´ì˜¨ë‹¤.
- ê¸°ì¡´ì—ëŠ” todoItemì¸ìë§Œ ë°›ì•˜ìœ¼ë‚˜ mutationsì—ì„œëŠ” ê¸°ë³¸ì ìœ¼ë¡œ stateì¸ìë¥¼ ë°›ê¸°ë•Œë¬¸ì— `state`ì™€ `todoItem`ì¸ìë¥¼ ë°›ëŠ”ë‹¤.
- ê¸°ì¡´ì˜ `this.todoItems.push(obj);` ì½”ë“œì—ì„œ this.todoItemì´ ì•„ë‹Œ stateë¡œ ì ‘ê·¼í•´ì•¼ í•˜ê¸°ë•Œë¬¸ì— `state.todoItems.push(obj);`ë¡œ ìˆ˜ì •í•œë‹¤.

### âœ” src>components>TodoList.vue

```jsx
<template>
  <div>
    <TransitionGroup name="list" tag="ul">
      <!-- <li v-for="(todoItem, index) in propsdata" v-bind:key="todoItem.item" class="shadow"> -->
      <!-- props ëŒ€ì‹  state.jsì˜ todoItemsë¡œ ì„¤ì •-->
      <li v-for="(todoItem, index) in this.$store.state.todoItems" v-bind:key="todoItem.item" class="shadow">
        <i class="checkBtn fa-solid fa-check" v-bind:class="{checkBtnCompleted: todoItem.completed}" v-on:click="toggleComplete(todoItem, index)"></i> <!-- checkë²„íŠ¼ ì¶”ê°€. í•´ë‹¹ ë²„íŠ¼ì„ í´ë¦­í–ˆì„ë•Œ ë™ì‘í• ìˆ˜ ìˆë„ë¡ v-on:clickì´ë²¤íŠ¸ ì¶”ê°€ -->
        <span v-bind:class="{textCompleted: todoItem.completed}"> 
          {{ todoItem.item }} 
        </span>
        <span class="removeBtn" v-on:click="removeTodo(todoItem, index)"> 
          <i class="fa-solid fa-trash-can"></i>
        </span>
      </li>
    <!-- </ul> -->
    </TransitionGroup>
  </div>
</template>

<script>
export default {
  methods: {
   // .....
  }
}
</script>

<style scoped> 
	/* ..... */
</style>
```

- TodoList.vueì™€ App.vueë¥¼ ì—°ê²°í•˜ëŠ”ê²ƒì´ ì•„ë‹ˆë¼ TodoList.vueì™€ state.jsì™€ ì—°ê²°í•˜ê¸°ë•Œë¬¸ì— v-forì˜ ë°°ì—´ì„propsdataëŒ€ì‹  state.jsì˜ todoItemsìœ¼ë¡œ ë³€ê²½í•œë‹¤.

### âœ” src>components>TodoList.vue

```jsx
<template>
  <!-- ..... ->
</template>

<script>
import AlertModal from "./common/AlertModal.vue";

export default {
  data(){
    return{
      newTodoItem: "",
      showModal: false
    }
  },
  methods: {
    addTodo(){
      if (this.newTodoItem !== '') {  
        // this.$emit('addTodoItem', this.newTodoItem);
        const text = this.newTodoItem.trim(); // trim : ì…ë ¥ëœ ê°’ì˜ ì•ë’¤ì˜ ê³µë°±ì„ ë¹„ì›Œì¤Œ
        this.$store.commit('addOneItem', text); // store.jsì— ìˆëŠ” mutationsì„ ë™ì‘ì‹œí‚¤ê¸°ìœ„í•´ commit â†’ ê¸°ì¡´ê³¼ ë˜‘ê°™ì´ ì¸ì ì „ë‹¬
        this.clearInput(); 
      } else {
        this.showModal = !this.showModal; // true/false ë³€í™˜
      }
    },
    clearInput(){
      this.newTodoItem = "";
    }
  },
  components: {
    AlertModal
  }
}
</script>

<style scoped>
	/* ..... */
</style>
```

- ê¸°ì¡´ì— event emitìœ¼ë¡œ newTodoItemì„ App.vueë¡œ ì˜¬ë ¸ì§€ë§Œ ì§€ê¸ˆì€ App.vueê°€ ì•„ë‹Œ store.jsì— ì—°ê²°ë˜ì—ˆë‹¤.
    
    ë”°ë¼ì„œ store.jsì— ìˆëŠ” mutationsë¥¼ ë™ì‘ì‹œí‚¤ê¸°ìœ„í•´ commitì„ ì‚¬ìš©í•´ ê¸°ì¡´ê³¼ ë™ì¼í•˜ê²Œ ì¸ìë¥¼ ì „ë‹¬í–ˆë‹¤.
    
    - ë” ì•ˆì „í•˜ê²Œ ì „ë‹¬í•˜ê¸°ìœ„í•´ì„œ newTodoItemì—ì„œ trimì„ ì œê±°í•˜ê³  textë¼ëŠ” ì¸ìì— ë‹´ì•„ ì „ë‹¬í–ˆë‹¤.

---

# [ë¦¬íŒ©í† ë§] í•  ì¼ ì§€ìš°ê¸° ê¸°ëŠ¥ êµ¬í˜„

<aside>
ğŸ’¡ App.vueì— ìˆë˜ removeOneItem ë©”ì„œë“œë¥¼ state.jsë¡œ ì´ë™ì‹œì¼œë³´ì

</aside>

### âœ” src>App.vue

```jsx
<template>
  <div id="app">
    <TodoHeader></TodoHeader>
    <TodoInput></TodoInput> 
    <TodoList v-bind:propsdata="todoItems" 
             // v-on:removeItem="removeOneItem" 
              v-on:toggleItem="toggleOneItem">
    </TodoList>  
    <TodoFooter v-on:clearAll="clearAllItems"></TodoFooter> 
  </div>
</template>

<script>
import .....

export default {
  data(){
    return {
      todoItems: [] 
    }
  },
  methods: { 
		// state.jsë¡œ ì´ë™
    // removeOneItem (todoItem, index) { 
    //   localStorage.removeItem(todoItem.item); 
    //   this.todoItems.splice(index, 1); 
    // },
    toggleOneItem (todoItem, index){
      // .....
    },
    clearAllItems(){
      // .....
    }
  },
  components: {
    // .....
	}
}
</script>

<style>
  // .....
</style>
```

- state.jsë¡œ removeOneItemì„ ì´ë™ì‹œí‚¤ê³  v-on ì´ë²¤íŠ¸ë¥¼ ì œê±°í•œë‹¤.

### âœ”  src>components>TodoList.vue

```jsx
<template>
  // .....
</template>

<script>
export default {
  methods: {
    removeTodo(todoItem, index){
      // this.$emit('removeItem', todoItem, index);
      
			// ê°ì²´í™” ë°©ë²• 1
      // const obj = {
      //   // todoItem: todoItem, â†’ ì„œë¡œ ë™ì¼í•˜ê¸°ë•Œë¬¸ì— ë‹¨ì¶• ê°€ëŠ¥
      //   todoItem,
      //   index
      // }
      // this.$store.commit('removeOneItem', obj);

      // ê°ì²´í™” ë°©ë²•2
      this.$store.commit('removeOneItem', {todoItem, index});

    },
    toggleComplete(todoItem, index){ 
      this.$store.commit('toggleItem', todoItem, index);
    }
  }
}
</script>

<style scoped>
	/* ..... */
</style>
```

- ë”°ë¡œë”°ë¡œ ë³´ë‚´ì¤˜ë„ ì‹¤í–‰ë˜ì§€ë§Œ todoItemê³¼ indexë¥¼ ê°™ì´ ë³´ë‚´ì£¼ê¸°ìœ„í•´ ê°ì²´í™”ë¥¼ í•´ì¤€ë‹¤.
    - ê°ì²´í™” ë°©ë²• 1 : const objë¡œ ë¬¶ì–´ì„œ objë¥¼ ì¸ìë¡œ ì „ë‹¬
    - ê°ì²´í™” ë°©ë²• 2 : commití• ë•Œ {}ë¡œ ë¬¶ì–´ì„œ ì¸ìë¥¼ ì „ë‹¬

### âœ”  src>store>store.js

```jsx
import Vue from 'vue'
import Vuex from 'vuex'

Vue.use(Vuex); 

const storage = {
	fetch() { 
		const arr = [];
			if (localStorage.length > 0) {
				for (let i = 0; i < localStorage.length; i++) { 
					arr.sort();
					if (localStorage.key(i) !== 'loglevel:webpack-dev-server') {
						arr.push(JSON.parse(localStorage.getItem(localStorage.key(i)))); 
					}
				}
			}
			return arr;
    }
};

export const store = new Vuex.Store({ 
    state: {
        todoItems: storage.fetch()
    },
    mutations: {
        addOneItem (state, todoItem) { 
            const obj = { completed: false, item: todoItem }; 
            localStorage.setItem(todoItem, JSON.stringify(obj));
            state.todoItems.push(obj);
        },
        // í€´ì¦ˆ
        removeOneItem (state, payload) { // payloadë¡œ ê°ì²´í™”í•œ ì¸ìë¥¼ ë°›ëŠ”ë‹¤.
            // payload.todoItem;
            // payload.index;
            localStorage.removeItem(payload.todoItem.item); 
            state.todoItems.splice(payload.index, 1); 
        },
				// ...
    }
});
```

- todoItemê³¼ indexë¥¼ payloadë¡œ í•œë²ˆì— ë°›ì•„ payload.todoItemê³¼ payload.indexë¡œ ì‚¬ìš©í•œë‹¤.

---

# [ë¦¬íŒ©í† ë§] í•  ì¼ ì™„ë£Œ êµ¬í˜„

<aside>
ğŸ’¡ App.vueì— ìˆë˜ toggleOneItem ë©”ì„œë“œë¥¼ state.jsë¡œ ì´ë™ì‹œì¼œë³´ì

</aside>

### âœ” src>App.vue

```jsx
<template>
  <div id="app">
    <TodoHeader></TodoHeader>
    <TodoInput></TodoInput> 
    <TodoList v-bind:propsdata="todoItems" 
             // v-on:removeItem="removeOneItem" 
             //v-on:toggleItem="toggleOneItem"
		>
    </TodoList>  
    <TodoFooter v-on:clearAll="clearAllItems"></TodoFooter> 
  </div>
</template>

<script>
import .....

export default {
  data(){
    return {
      todoItems: [] 
    }
  },
  methods: { 
		// state.jsë¡œ ì´ë™
    // toggleOneItem (todoItem, index){
      // .....
    //},
    clearAllItems(){
      // .....
    }
  },
  components: {
    // .....
	}
}
</script>

<style>
  // .....
</style>
```

- state.jsë¡œ toggleOneItemì„ ì´ë™ì‹œí‚¤ê³  v-on ì´ë²¤íŠ¸ë¥¼ ì œê±°í•œë‹¤.

### âœ”  src>components>TodoList.vue

```jsx
<template>
  <!-- ..... -->
</template>

<script>
export default {
  methods: {
    removeTodo(todoItem, index){
      this.$store.commit('removeOneItem', {todoItem, index});

    },
    toggleComplete(todoItem, index){ 
			// event emitëŒ€ì‹  commitìœ¼ë¡œ ë³€ê²½
      this.$store.commit('toggleItem', todoItem, index);
    }
  }
}
</script>

<style scoped>
	/* ..... */
</style>
```

- event emit ëŒ€ì‹  commitìœ¼ë¡œ ì¸ìë¥¼ ê°ì²´í™”í•´ store.jsë¡œ ë³´ë‚´ì¤€ë‹¤.

### âœ”  src>store>store.js

```jsx
import Vue from 'vue'
import Vuex from 'vuex'

Vue.use(Vuex); 

const storage = {
	fetch() { 
		const arr = [];
			if (localStorage.length > 0) {
				for (let i = 0; i < localStorage.length; i++) { 
					arr.sort();
					if (localStorage.key(i) !== 'loglevel:webpack-dev-server') {
						arr.push(JSON.parse(localStorage.getItem(localStorage.key(i)))); 
					}
				}
			}
			return arr;
    }
};

export const store = new Vuex.Store({ 
    state: {
        todoItems: storage.fetch()
    },
    mutations: {
        addOneItem (state, todoItem) { 
           // .....
        },
        removeOneItem (state, payload) { 
	        // .....
        },
				toggleOneItem (state, payload){
            state.todoItems[payload.index].completed = !state.todoItems[payload.index].completed; 
            localStorage.removeItem(payload.todoItem.item);
            localStorage.setItem(payload.todoItem.item, JSON.stringify(payload.todoItem));
        }
    }
});
```

- todoItemê³¼ indexë¥¼ payloadë¡œ í•œë²ˆì— ë°›ì•„ payload.todoItemê³¼ payload.indexë¡œ ì‚¬ìš©í•œë‹¤.

---

# [ë¦¬íŒ©í† ë§] í•  ì¼ ëª¨ë‘ ì‚­ì œ êµ¬í˜„

<aside>
ğŸ’¡ App.vueì— ìˆë˜ clearAllItems ë©”ì„œë“œë¥¼ state.jsë¡œ ì´ë™ì‹œì¼œë³´ì

</aside>

### âœ” src>App.vue

```jsx
<template>
  <div id="app">
    <TodoHeader></TodoHeader>
    <TodoInput></TodoInput> 
    <TodoList></TodoList>  
    // <TodoFooter v-on:clearAll="clearAllItems"></TodoFooter> 
		<TodoFooter></TodoFooter> 
  </div>
</template>

<script>
import .....

export default {
  // data(){
  //  return {
  //    todoItems: [] 
  //  }
  // },
  // methods: { 
		// state.jsë¡œ ì´ë™
    // clearAllItems(){
      // .....
    // }
  // },
  components: {
    // .....
	}
}
</script>

<style>
  // .....
</style>
```

- state.jsë¡œ clearAllItemsì„ ì´ë™ì‹œí‚¤ê³  v-on ì´ë²¤íŠ¸ë¥¼ ì œê±°í•œë‹¤.
- dataì™€ methodsë˜í•œ ë”ì´ìƒ ì“°ì´ì§€ ì•Šê¸°ë•Œë¬¸ì— ì‚­ì œí•œë‹¤.

### âœ”  src>components>TodoList.vue

```jsx
<template>
  // .....
</template>

<script>
export default {
  methods: {
    clearTodo(){
      // this.$emit('clearAll'); 
      this.$store.commit('clearAllItems');
    }
  }
}
</script>

<style scoped>
	/* ..... */
</style>
```

- event emit ëŒ€ì‹  commitìœ¼ë¡œ  store.jsë¡œ ë³´ë‚´ì¤€ë‹¤.

### âœ”  src>store>store.js

```jsx
import Vue from 'vue'
import Vuex from 'vuex'

Vue.use(Vuex); 

const storage = {
	fetch() { 
		const arr = [];
			if (localStorage.length > 0) {
				for (let i = 0; i < localStorage.length; i++) { 
					arr.sort();
					if (localStorage.key(i) !== 'loglevel:webpack-dev-server') {
						arr.push(JSON.parse(localStorage.getItem(localStorage.key(i)))); 
					}
				}
			}
			return arr;
    }
};

export const store = new Vuex.Store({ 
    state: {
        todoItems: storage.fetch()
    },
    mutations: {
        addOneItem (state, todoItem) { 
           // .....
        },
        removeOneItem (state, payload) { 
	        // .....
        },
				toggleOneItem (state, payload){
          // .....
				},
        clearAllItems(state){
            localStorage.clear(); 
            state.todoItems = [];
        }
    }
});
```

<aside>
âœ… ìœ„ ë‚´ìš©ìœ¼ë¡œ ìˆ˜ì •ì‹œ ê¸°ì¡´ ì½”ë“œì²˜ëŸ¼ ì‘ë™ë˜ëŠ”ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆì—ˆë‹¤.

</aside>

---

# ì™œ stateëŠ” ì§ì ‘ ë³€ê²½í•˜ì§€ ì•Šê³  mutationsë¡œ ìƒíƒœë¥¼ ë³€ê²½í•´ì•¼ í•˜ëŠ”ê°€?

ì—¬ëŸ¬ê°œì˜ ì»´í¬ë„ŒíŠ¸ì—ì„œ ì•„ë˜ì™€ ê°™ì´ `state`ê°’ì„ ë³€ê²½í•˜ëŠ” ê²½ìš° ì–´ëŠ ì»´í¬ë„ŒíŠ¸ì—ì„œ í•´ë‹¹ stateë¥¼ ë³€ê²½í–ˆëŠ”ì§€ ì¶”ì í•˜ê¸°ê°€ ì–´ë µë‹¤.

```jsx
methods: {
	increaseCounter() { this.$store.state.counter++; }
}
```

íŠ¹ì • ì‹œì ì— ì–´ë–¤ ì»´í¬ë„ŒíŠ¸ê°€ stateë¥¼ ì ‘ê·¼í•˜ì—¬ ë³€ê²½í•œ ê±´ì§€ í™•ì¸í•˜ê¸° ì–´ë µê¸° ë•Œë¬¸

ë”°ë¼ì„œ, ë·°ì˜ ë°˜ì‘ì„±ì„ ê±°ìŠ¤ë¥´ì§€ ì•Šê²Œ ëª…ì‹œì ìœ¼ë¡œ ìƒíƒœ ë³€í™”ë¥¼ ìˆ˜í–‰. **ë°˜ì‘ì„±, ë””ë²„ê¹…, í…ŒìŠ¤íŒ… í˜œíƒ.**

---

# actions ì†Œê°œ ë° ì˜ˆì œ

### âœ” actions

ë¹„ë™ê¸° ì²˜ë¦¬ ë¡œì§ì„ ì„ ì–¸í•˜ëŠ” ë©”ì„œë“œ

ë¹„ë™ê¸° ë¡œì§ì„ ë‹´ë‹¹í•˜ëŠ” mutations

ë°ì´í„° ìš”ì²­, `Promise`, ES6 asyncê³¼ ê°™ì€ `ë¹„ë™ê¸° ì²˜ë¦¬`ëŠ” ëª¨ë‘ actionsì— ì„ ì–¸í•œë‹¤.

<aside>
ğŸ’¡ `Promise` ì´í•´í•˜ê¸°

[ìë°”ìŠ¤í¬ë¦½íŠ¸ Promise ì‰½ê²Œ ì´í•´í•˜ê¸°](https://joshua1988.github.io/web-development/javascript/promise-for-beginners/)

`ë¹„ë™ê¸° ì²˜ë¦¬` ì´í•´í•˜ê¸°

[ìë°”ìŠ¤í¬ë¦½íŠ¸ ë¹„ë™ê¸° ì²˜ë¦¬ì™€ ì½œë°± í•¨ìˆ˜](https://joshua1988.github.io/web-development/javascript/javascript-asynchronous-operation/)

</aside>

```jsx
// store.js
state: {
	num: 10
},
mutations: {
	dobleNumber(state) {
		state.num * 2;
	}
}, 
actions: {
	delayDoubleNumber(context) { //contextë¡œ storeì˜ ë©”ì„œë“œì™€ ì†ì„± ì ‘ê·¼
		context.commit('doubleNumber');
	}
}
// App.vue
this.$store.dispatch('delayDoubleNumber');
```

1. App.vueì—ì„œ this.$store.dispatchë¼ëŠ” actionì„ ë°œë™
2. â€˜delayDoubleNumberâ€™ë¼ëŠ” actionì´ í˜¸ì¶œ
3. actionì—ì„œ commitì„ í•˜ë©´ doubleNumberë¼ëŠ” mutationsë¥¼ í˜¸ì¶œ

â†’ ì´ëŸ°ì‹ìœ¼ë¡œ actionsì€ ì¤‘ê°„ì— ë¹„ë™ê¸° ë¡œì§ë“¤ì„ ë„£ì–´ ì¤„ ìˆ˜ ìˆë‹¤.

### âœ” actions ë¹„ë™ê¸° ì½”ë“œ ì˜ˆì œ 1 : setTimeout

```jsx
// store.js
mutations: {
	addCounter(state) {
		state.counter++
	},
},
actions: {
	delayedAddCounter(context) {
		setTimeOut(() => context.commit('addCounter'), 2000);
	}
}

// App.vue
methods: {
	incrementCounter() {
		this.$store.dispatch('delayedAddCounter');
	}
}
```

- mutationsì€ commitì´ë¼ëŠ” APIë¥¼ í˜¸ì¶œí•´ì„œ mutationsë¥¼ í˜¸ì¶œì‹œí‚¤ê³ , actionsëŠ” dispatchë¼ëŠ” APIë¥¼ í˜¸ì¶œí•´ì„œ actionsì„ í˜¸ì¶œí•œë‹¤.
1. incrementCounterë¼ëŠ” ë©”ì„œë“œë¥¼ ì‹¤í–‰ì‹œí‚¤ë©´ delayedAddCounterë¼ëŠ” actionsì„ ì‹¤í–‰ì‹œí‚¨ë‹¤.
2. storeì—ì„œ delayedAddCounterì´ ì‹¤í–‰ë˜ê³  setTimeoutì´ 2ì´ˆ í›„ì— addCounterì„ ì‹¤í–‰í•œë‹¤.

### âœ” actions ë¹„ë™ê¸° ì½”ë“œ ì˜ˆì œ 2 : ì„œë²„ì— ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì™€ì„œ í™”ë©´ì— ì—°ê²°

```jsx
// store.js
mutations: {
	setData (state, fetchedData) {
		state.product = fetchedData
	},
},
actions: {
	fetchProductData(context) {
		return axios.get('https://domain.com/products/1')
								.then(response => context.commit('setData', response));
	}
}

// App.vue
methods: {
	getProduct() {
		this.$store.dispatch('fetchProductData');
	}
}
```

1. getProduct ë©”ì„œë“œ ì‹¤í–‰ì‹œ fetchProductDataë¼ëŠ” actionsì„ ì‹¤í–‰ì‹œí‚¨ë‹¤.
2. storeì—ì„œ fetchProductDataê°€ ì‹¤í–‰ë˜ê³  axiosê°€ getì´ë¼ëŠ” ë°ì´í„° ìš”ì²­ì„ ì„œë²„ì— ë³´ë‚¸ë‹¤.
    
    ë°ì´í„°ë¥¼ ë°›ì•„ì˜¤ë©´ â‡’ (Promise ì½œë°±)ìœ¼ë¡œ  responseë¥¼ ë°›ì•„ì„œ setDataë¼ëŠ” responseë¥¼ ì»¤ë°‹í•œë‹¤.
    
3. setDataì—ì„œëŠ” ë°›ì•„ì˜¨ fetchedDataë¥¼ state.productì— ë„£ì–´ì¤€ë‹¤.

---

# ì™œ actionsì— ë¹„ë™ê¸° ë¡œì§ì„ ì„ ì–¸í•´ì•¼ í•˜ëŠ”ê°€?

ì–¸ì œ ì–´ëŠ ì»´í¬ë„ŒíŠ¸ì—ì„œ í•´ë‹¹ `state`ë¥¼ í˜¸ì¶œí•˜ê³ , ë³€ê²½í–ˆëŠ”ì§€ í™•ì¸í•˜ê¸°ê°€ ì–´ë µë‹¤.

![ì—¬ëŸ¬ ê°œì˜ ì»´í¬ë„ŒíŠ¸ì—ì„œ mutationsë¡œ ì‹œê°„ ì°¨ë¥¼ ë‘ê³  stateë¥¼ ë³€ê²½í•˜ëŠ” ê²½ìš°](Vuex%20-%20%E1%84%8C%E1%85%AE%E1%84%8B%E1%85%AD%20%E1%84%80%E1%85%B5%E1%84%89%E1%85%AE%E1%86%AF%20%E1%84%8B%E1%85%AD%E1%84%89%E1%85%A9%20b3fa334d7a4a435eb5ae70c839b3d960/Untitled.png)

ì—¬ëŸ¬ ê°œì˜ ì»´í¬ë„ŒíŠ¸ì—ì„œ mutationsë¡œ ì‹œê°„ ì°¨ë¥¼ ë‘ê³  stateë¥¼ ë³€ê²½í•˜ëŠ” ê²½ìš°

<aside>
ğŸ’¡ **stateê°’ì˜ ë³€í™”ë¥¼ ì¶”ì í•˜ê¸° ì–´ë µê¸°ë•Œë¬¸ì— mutations ì†ì„±ì—ëŠ” ë™ê¸° ì²˜ë¦¬ ë¡œì§ë§Œ ë„£ì–´ì•¼ í•œë‹¤.**

</aside>