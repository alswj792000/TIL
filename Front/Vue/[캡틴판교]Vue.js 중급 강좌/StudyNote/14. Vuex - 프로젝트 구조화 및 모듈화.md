# Vuex - í”„ë¡œì íŠ¸ êµ¬ì¡°í™” ë° ëª¨ë“ˆí™”

ì„¹ì…˜: Vuex
ìˆ˜ê°•ì¼: 2022ë…„ 10ì›” 21ì¼
ì§„í–‰ë„: 1

# ìŠ¤í† ì–´ ì†ì„± ëª¨ë“ˆí™” ë°©ë²•

ë‹¤ìŒê³¼ ê°™ì€ store êµ¬ì¡°ë¥¼ ëª¨ë“ˆí™”í•˜ëŠ” ë°©ë²•ì€?

```jsx
// store.js
import Vue from 'vue'
import Vuex from 'vuex'

export const store = new Vuex.Store({
	state: {},
	getters: {},
	mutations: {},
	actions: {}
});
```

â†’ `Vuex.store({})`ì˜ ì†ì„±ë“¤ì„ ëª¨ë“ˆë¡œ ì—°ê²°

### âœ” ES6ì˜ Import&Exportë¥¼ ì´ìš©í•˜ì—¬ ì†ì„±ë³„ë¡œ ëª¨ë“ˆí™”

```jsx
import Vue from 'vue'
import Vuex from 'vuex'
import * as getters from 'store/getters.js'
import * as mutations from 'store/mutations.js'
import * as actions from 'store/action.js'

export const store = new Vuex.Store({
	state: {},
	getters: getters,
	mutations: mutations,
	actions: actions
});
```

## [ ë¦¬íŒ©í† ë§ ] ëª¨ë“ˆí™”

### âœ” src>store>store.js

```jsx
import Vue from 'vue'
import Vuex from 'vuex'
// ëª¨ë“ˆí™”
import * as getters from './getters'
import * as mutations from './mutations'

Vue.use(Vuex); 

const storage = {
    // .....
};

export const store = new Vuex.Store({ 
    state: {
        todoItems: storage.fetch()
    },
		getters, // gettersì—°ë™ ) getters: getters,
    // getters: { 
    //     storedTodoItems(state){ 
    //         return state.todoItems;
    //     }
    // },

    mutations // mutations ì—°ë™ ) mutations: mutations
    // mutations: {
    //     addOneItem (state, todoItem) { 
    //         const obj = { completed: false, item: todoItem }; 
    //         localStorage.setItem(todoItem, JSON.stringify(obj));
    //         state.todoItems.push(obj);
    //     },
    //     removeOneItem (state, payload) { 
    //         localStorage.removeItem(payload.todoItem.item); 
    //         state.todoItems.splice(payload.index, 1); 
    //     },
    //     toggleOneItem (state, payload){
    //         state.todoItems[payload.index].completed = !state.todoItems[payload.index].completed; 
    //         localStorage.removeItem(payload.todoItem.item);
    //         localStorage.setItem(payload.todoItem.item, JSON.stringify(payload.todoItem));
    //     },
    //     clearAllItems(state){
    //         localStorage.clear(); 
    //         state.todoItems = []; 
    //     }
    // }
    
});
```

1. store.jsì— ìžˆëŠ” gettersë¥¼ getters.jsë¡œ ì˜®ê¸´ë‹¤.
2. store.jsì— ìžˆëŠ” mutationsë¥¼ mutations.jsë¡œ ì˜®ê¸´ë‹¤.
3. gettersì™€ mutationsì„ importí•´ì¤€ë‹¤.
    - `import * as getters/mutations from â€˜./getters or mutationsâ€™`
4. getters/mutationsë¥¼ ì—°ë™í•´ì¤€ë‹¤.
    - ì„œë¡œ ì´ë¦„ì´ ê°™ê¸°ë•Œë¬¸ì— **ì¶•ì•½**ì´ ê°€ëŠ¥í•˜ë‹¤.

### âœ” src>store>getters.js

ðŸŸ¢ **ë°©ë²•1**.  `export const ë©”ì„œë“œëª… = (ì¸ìž) â‡’ {}`

```jsx
export const storedTodoItems = (state) => { 
	return state.todoItems;
}
```

1. src/storeì— getters.jsë¥¼ ìƒì„±í•œë‹¤.
2. store.jsì—ì„œ gettersë¥¼ ê°€ì ¸ì˜¨ë‹¤.
3. ê°€ì ¸ì˜¨ ì½”ë“œë¥¼ `export const ë©”ì„œë“œëª… = (ì¸ìž) â‡’ {}` í˜•íƒœë¡œ ë³€ê²½í•´ì¤€ë‹¤.

### âœ” src>store>mutation.js

ðŸŸ¢ **ë°©ë²•2**. `const ë©”ì„œë“œëª… = (ì¸ìž) â‡’ {} - export {}`

```jsx
const addOneItem = (state, todoItem) => { 
    const obj = { completed: false, item: todoItem };
    localStorage.setItem(todoItem, JSON.stringify(obj));
    state.todoItems.push(obj);
}

const removeOneItem = (state, payload) => { 
    localStorage.removeItem(payload.todoItem.item); 
    state.todoItems.splice(payload.index, 1); 
}

const toggleOneItem = (state, payload) => {
    state.todoItems[payload.index].completed = !state.todoItems[payload.index].completed; 
    localStorage.removeItem(payload.todoItem.item);
    localStorage.setItem(payload.todoItem.item, JSON.stringify(payload.todoItem));
}

const clearAllItems = (state) => {
    localStorage.clear(); 
    state.todoItems = []; 
}

export { addOneItem, removeOneItem, toggleOneItem, clearAllItems }
// export ì‚¬ìš© í™”ì‚´í‘œ í•¨ìˆ˜ë¥¼ ì´ìš©í•œ í•¨ìˆ˜ì‹ì´ storeë¡œ ë¹ ì§ˆìˆ˜ ìžˆë‹¤.
```

1. src/storeì— mutations.jsë¥¼ ìƒì„±í•œë‹¤.
2. store.jsì—ì„œ mutationsë¥¼ ê°€ì ¸ì˜¨ë‹¤.
3. ê°€ì ¸ì˜¨ ì½”ë“œë¥¼ `const ë©”ì„œë“œëª… = (ì¸ìž) â‡’ {}` í˜•íƒœë¡œ ë³€ê²½í•´ì¤€ë‹¤.
- ì´ë•Œ ì½”ë“œë“¤ì€ ê°ì²´ ì•ˆì´ ì•„ë‹ˆë¼ ê°ê°ì˜ ì†ì„±ì´ê¸°ë•Œë¬¸ì— `,`ëŠ” í•„ìš”ì—†ë‹¤.
1. exportì„ ì‚¬ìš©í•´ í™”ì‚´í‘œ í•¨ìˆ˜ë¥¼ ì´ìš©í•œ í•¨ìˆ˜ì‹ì´ storeë¡œ ë¹ ì§ˆìˆ˜ ìžˆë‹¤.

---

# ìŠ¤í† ì–´ ëª¨ë“ˆí™” ë°©ë²•

ì•±ì´ ë¹„ëŒ€í•´ì ¸ì„œ 1ê°œì˜ storeë¡œëŠ” ê´€ë¦¬ê°€ íž˜ë“¤ ë•Œ modules ì†ì„±ì„ ì‚¬ìš©í•œë‹¤.

```jsx
// store.js
import Vue for 'vue'
import Vuex from 'vuex'
import todo from 'modules/todo.js'

export const store = new Vuex.Store({
	modules: {
		moduleA: todo, // ëª¨ë“ˆ ëª…ì¹­ : ëª¨ë“ˆ íŒŒì¼ëª…
		todo // todo: todo
	}
});

// todo.js
const state = {}
const getters = {}
const mutations = {}
const actions = {}
```

### âœ” src>store>modules>todoApp.vue

```jsx
const storage = {
    fetch() { 
        const arr = [];
        if (localStorage.length > 0) {
            for (let i = 0; i < localStorage.length; i++) { 
                arr.sort();
                if (localStorage.key(i) !== 'loglevel:webpack-dev-server') {
                    arr.push(JSON.parse(localStorage.getItem(localStorage.key(i)))); 
                }
            }
        }
        return arr;
    }
};

const state = {
    todoItems: storage.fetch()
};

const getters = {
    // getters ë‚´ìš© ë“¤ê³ ì˜¤ê¸° â†’ í™”ì‚´í‘œ í•¨ìˆ˜ ì œê±°
    storedTodoItems(state) { 
    return state.todoItems;
    }
};

const mutations = {
    // mutations ë‚´ìš© ë“¤ê³ ì˜¤ê¸° â†’ í™”ì‚´í‘œ í•¨ìˆ˜ ì œê±°
    addOneItem(state, todoItem) { 
    const obj = { completed: false, item: todoItem };
    localStorage.setItem(todoItem, JSON.stringify(obj));
    state.todoItems.push(obj);
    },
    removeOneItem(state, payload) { 
        localStorage.removeItem(payload.todoItem.item); 
        state.todoItems.splice(payload.index, 1); 
    },
    toggleOneItem(state, payload) {
        state.todoItems[payload.index].completed = !state.todoItems[payload.index].completed; 
        localStorage.removeItem(payload.todoItem.item);
        localStorage.setItem(payload.todoItem.item, JSON.stringify(payload.todoItem));
    },
    clearAllItems(state) {
        localStorage.clear(); 
        state.todoItems = []; 
    }
};

export default { // í•œê°œì˜ íŒŒì¼ì—ì„œ í•œê°œë§Œ ì¶”ì¶œ ê°€ëŠ¥
    state,
    getters,
    mutations
}
```

1. state.jsì—ì„œ storageì™€ stateì½”ë“œë¥¼ ê°€ì ¸ì˜¨ë‹¤.
2. gettersì™€ mutationsì—ì„œ ì½”ë“œë¥¼ ê°€ì ¸ì˜¨ë‹¤.
    - ì´ë•Œ ê¸°ì¡´ì— ìž‘ì„±í–ˆë˜ í™”ì‚´í‘œ ì½”ë“œë¥¼ ì œê±°í•´ì„œ ê°€ì ¸ì˜¨ë‹¤.
3. export defultë¥¼ ì‚¬ìš©í•´ state, getters, mutationsë¥¼ í•œë²ˆì— exportí•œë‹¤.
    - export default : í•œê°œì˜ íŒŒì¼ì—ì„œ í•œê°œë§Œ ì¶”ì¶œ ê°€ëŠ¥í•˜ë‹¤.

### âœ” src>store>store.js

```jsx
import Vue from 'vue'
import Vuex from 'vuex'
// ëª¨ë“ˆí™”
import todoApp from './modules/todoApp'

Vue.use(Vuex); 

// const storage = {
//     fetch() { 
//         const arr = [];
//         if (localStorage.length > 0) {
//             for (let i = 0; i < localStorage.length; i++) { 
//                 arr.sort();
//                 if (localStorage.key(i) !== 'loglevel:webpack-dev-server') {
//                     arr.push(JSON.parse(localStorage.getItem(localStorage.key(i)))); 
//                 }
//             }
//         }
//         return arr;
//     }
// };

export const store = new Vuex.Store({ 
    // state: {
    //     todoItems: storage.fetch()
    // },
    // getters, 
    // mutations 
    modules: {
        todoApp // todoApp: todoApp) todoAppì—ì„œ ì„ ì–¸í•œ ë‚´ìš©ë“¤ì´ ë‹´ê²¨ì„œ ë„˜ì–´ì˜¨ë‹¹
    }
});
```

1. todoApp.vueë¥¼ importí•œë‹¤.
2. storageì™€ stateë¥¼ todoApp.vueë¡œ ì´ë™ì‹œí‚¨ë‹¤.
3. export const storeì•ˆì— modulesë¥¼ ì„ ì–¸í•˜ê³  todoApp: todoAppìœ¼ë¡œ todoApì—ì„œ ì„ ì–¸í•œ ë‚´ìš©ì„ ë„˜ê²¨ë°›ëŠ”ë‹¤.